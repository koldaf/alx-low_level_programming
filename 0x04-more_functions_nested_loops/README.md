More funtions and nested loop
